<!DOCTYPE html><html data-pathToRoot="../../"><head><meta charset="utf-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"></meta><title>核心概念</title><link rel="shortcut icon" type="image/x-icon" href="../../favicon.ico"></link><script type="text/javascript" src="../../scripts/theme.js"></script><script type="text/javascript" src="../../scripts/searchData.js" defer="true"></script><script type="text/javascript" src="../../scripts/scastieConfiguration.js" defer="true"></script><link rel="stylesheet" href="../../styles/theme/bundle.css"></link><link rel="stylesheet" href="../../styles/theme/components/bundle.css"></link><link rel="stylesheet" href="../../styles/theme/components/button/bundle.css"></link><link rel="stylesheet" href="../../styles/theme/layout/bundle.css"></link><link rel="stylesheet" href="../../styles/nord-light.css"></link><link rel="stylesheet" href="../../styles/dotty-icons.css"></link><link rel="stylesheet" href="../../styles/filter-bar.css"></link><link rel="stylesheet" href="../../styles/code-snippets.css"></link><link rel="stylesheet" href="../../styles/searchbar.css"></link><link rel="stylesheet" href="../../styles/social-links.css"></link><link rel="stylesheet" href="../../styles/versions-dropdown.css"></link><link rel="stylesheet" href="../../styles/content-contributors.css"></link><link rel="stylesheet" href="../../styles/fontawesome.css"></link><script type="text/javascript" src="../../hljs/highlight.pack.js" defer="true"></script><script type="text/javascript" src="../../scripts/hljs-scala3.js" defer="true"></script><script type="text/javascript" src="../../scripts/ux.js" defer="true"></script><script type="text/javascript" src="../../scripts/common/component.js" defer="true"></script><script type="text/javascript" src="../../scripts/common/utils.js" defer="true"></script><script type="text/javascript" src="../../scripts/components/FilterBar.js" defer="true"></script><script type="text/javascript" src="../../scripts/components/DocumentableList.js" defer="true"></script><script type="text/javascript" src="../../scripts/components/Input.js" defer="true"></script><script type="text/javascript" src="../../scripts/components/FilterGroup.js" defer="true"></script><script type="text/javascript" src="../../scripts/components/Filter.js" defer="true"></script><script type="text/javascript" src="../../scripts/scaladoc-scalajs.js" defer="true"></script><script type="text/javascript" src="../../scripts/contributors.js" defer="true"></script><script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js" defer="true"></script><script type="text/javascript" src="https://d3js.org/d3.v6.min.js" defer="true"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/graphlib-dot@0.6.2/dist/graphlib-dot.min.js" defer="true"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/dagre-d3/0.6.1/dagre-d3.min.js" defer="true"></script><script type="text/javascript" src="https://scastie.scala-lang.org/embedded.js" defer="true"></script><script type="text/javascript" src="../../scripts/data.js" defer="true"></script><link rel="stylesheet" href="../../styles/staticsitestyles.css"></link><script>var pathToRoot = "../../";</script><meta charset="utf-8"> 
<title>Hello, world!</title></head><body><div id=""><div id="header" class="body-small"><div class="header-container-left"><a href="../../home.html" class="logo-container"><span class="project-name h300">otavia</span></a><span onclick="dropdownHandler(event)" class="text-button with-arrow" id="dropdown-trigger"><a><div class="projectVersion">0.3.2-SNAPSHOT</div></a></span><div id="version-dropdown" class="dropdown-menu"></div></div><div class="header-container-right"><button id="search-toggle" class="icon-button"></button><span id="theme-toggle" class="icon-button"></span><span id="mobile-menu-toggle" class="icon-button hamburger"></span></div></div><div id="mobile-menu"><div class="mobile-menu-header body-small"><span class="mobile-menu-logo"><span class="project-name h300">otavia</span></span><button id="mobile-menu-close" class="icon-button close"></button></div><div class="mobile-menu-container body-medium"><input id="mobile-scaladoc-searchbar-input" class="scaladoc-searchbar-input" type="search" placeholder="Find anything"></input><span id="mobile-theme-toggle" class="mobile-menu-item mode"></span></div></div><span id="mobile-sidebar-toggle" class="floating-button"></span><div id="leftColumn" class="body-small"><div class="switcher-container"><a id="docs-nav-button" class="switcher h100 selected" href="../index.html">Docs</a><a id="api-nav-button" class="switcher h100 " href="../../index.html">API</a></div><nav id="docs-nav" class="side-menu"><div class="ni n0 "><span class="nh de"><a href="../quick_start.html"><span>Quick Start</span></a></span></div><div class="ni n0 "><span class="nh de"><a href="../core_concept.html"><span>Core Concept</span></a></span></div><div class="ni n0"><span class="nh de"><button class="ar icon-button "></button><a href="../guide/index.html"><span>Guide</span></a></span><div class="ni n1 "><span class="nh de"><a href="../guide/actor_model.html"><span>Actor Model</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../guide/channel_pipeline.html"><span>Channel Pipeline</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../guide/io_model.html"><span>IO Model</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../guide/ioc.html"><span>Actor IOC </span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../guide/message_model.html"><span>Message Model</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../guide/reactor_model.html"><span>Reactor Model</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../guide/slf4a.html"><span>SLF4A</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../guide/serde.html"><span>Serde framework</span></a></span></div></div><div class="ni n0"><span class="nh de"><button class="ar icon-button "></button><a href="../module/index.html"><span>Modules</span></a></span><div class="ni n1 "><span class="nh de"><a href="../module/buffer.html"><span>Buffer</span></a></span></div></div><div class="ni n0 expanded"><span class="nh h100 expanded cs de"><button class="ar icon-button expanded"></button><a href="index.html"><span>中文文档</span></a></span><div class="ni n1 "><span class="nh de"><a href="quick_start.html"><span>快速开始</span></a></span></div><div class="ni n1 expanded"><span class="nh h100 selected de"><a href="#"><span>核心概念</span></a></span></div><div class="ni n1"><span class="nh de"><button class="ar icon-button "></button><a href="guide/index.html"><span>Guide</span></a></span><div class="ni n2 "><span class="nh de"><a href="guide/channel_pipeline.html"><span>Channel Pipeline</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="guide/io_model.html"><span>IO Model</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="guide/ioc.html"><span>Actor IOC </span></a></span></div><div class="ni n2 "><span class="nh de"><a href="guide/message_model.html"><span>Message Model</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="guide/reactor_model.html"><span>Reactor Model</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="guide/slf4a.html"><span>SLF4A</span></a></span></div></div><div class="ni n1"><span class="nh de"><button class="ar icon-button "></button><a href="module/index.html"><span>Modules</span></a></span><div class="ni n2 "><span class="nh de"><a href="module/buffer.html"><span>Buffer</span></a></span></div></div></div><div class="ni n0"><span class="nh de"><button class="ar icon-button "></button><a href="../blog/index.html"><span>Blog</span></a></span><div class="ni n1 "><span class="nh de"><a href="../blog/2023/05/19/hello-world-blog.zh-cn.html"><span>你好世界</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../blog/2023/05/19/hello-world-blog.html"><span>hello world blog</span></a></span></div></div></nav></div><div id="footer" class="body-small"><div class="left-container">Generated with</div><div class="right-container"><a href="https://github.com/otavia-projects/otavia"><button class="icon-button gh"></button></a><div class="text">Copyright (c) 2022, Yan Kun/Otavia Project</div></div><div class="text-mobile">Copyright (c) 2022, Yan Kun/Otavia Project</div></div><div id="scaladoc-searchBar"></div><div id="main"><div class="breadcrumbs container"><a href="../index.html">otavia</a>/<a href="index.html">中文文档</a>/<a href="core_concept.html">核心概念</a></div><div id="content" class="body-medium"><div><section id="现有编程模型的挑战-1"> 
 <h2 class="h500"><a href="#现有编程模型的挑战-1" class="anchor"></a>现有编程模型的挑战</h2> 
 <p>随着摩尔定律的逐渐失效与现代软件系统规模的疯狂增长，单核CPU甚至单机已经不能很好的满足要求。为了应对这种挑战，现代软件系统不仅 需要在单机上很好运用多核CPU，甚至还需要将一个系统分布运行在多台计算机上完成业务。这些挑战严重的冲击着目前的主流编程范式，也让 目前主流编程范式向新的方向进化。</p> 
 <p>第一是异步编程，但是面向对象编程范式和异步结合的时候往往产生回调地狱，这种方法破坏了面向对象的封装性，而且也是代码逻辑更加分散， 使软件变得不容易维护。</p> 
 <p>第二是函数式编程变得更加流行，目前基本主流的编程语言都支持部分函数式特性了。函数式编程提出了一个美好的愿景：一切都是不可变的， 这使得编写代码就像定义一个数学函数，一旦函数完成定义，每次调用时只要输入一致那么输出也一致，除此之外不会有任何其余行为。这种 编程范式是一种很美妙的思想，采用这种方式编写的代码不仅安全而且更加容易测试，代码的行为也更可控。但是函数式也有一个致命的缺点： 那就是不容易处理状态，而一个现实的软件系统往往需要处理很多状态、IO等。虽然函数式编程也有Monad、Effect等组件来处理状态，但是 这些技术对于很多开发者来说难以理解，而且学习成本很高。</p> 
 <p>与此同时，有一个古老的编程范式似乎更加适合处理这种复杂的高并发分布式的软件系统。这就是1973提出的Actor模型。但是Actor模型 也同样存在一些缺点使其并没有向面向对象编程那样大规模流行起来。</p> 
 <p><code>otavia</code> 是基于 <code>Scala 3</code> 实现的一个Actor编程模型，并且希望探索出一条Actor模型与现代编程语言进行更加有效结合的路径， 也希望探索出一些方法解决传统Actor模型的一些缺陷。文章以下内容将概括式的介绍 <code>otavia</code> 中的核心概念与设计。</p> 
</section> 
<section id="核心运行时-1"> 
 <h2 class="h500"><a href="#核心运行时-1" class="anchor"></a>核心运行时</h2> 
 <p><code>otavia</code> 中并发与资源的基本单元为 <code>Actor</code>, 对于大多数场景来说，用户只需要实现各种自定义的 <code>Actor</code> 然后通过 <code>Actor</code> 之间 的消息交互来实现整体的系统功能。但是在现有的编程基础设施中，要做到理想的 <code>Actor</code> 编程模型并不简单，因为真实的编程场景不只是程 序内部组件的交互，还涉及与系统外部的其他组件进行交互，而这又涉及 IO 编程，甚至还涉及定时任务。为了满足这些需求，<code>otavia</code> 在 原始Actor模型的基础上增加了一些新的组件。</p> 
 <p>构成 <code>otavia</code> 运行时的核心组件是：</p> 
 <ul> 
  <li><code>Actor</code>: <code>Actor</code> 是 <code>otavia</code> 中并发与资源的基本单元，其有两个基本子类。<code>Actor</code> 之间通过发送消息进行通信。 
   <ul> 
    <li><code>StateActor</code>：普通 <code>Actor</code> 。</li> 
    <li><code>ChannelsActor</code>： 用于处理 IO 的 <code>Actor</code> 。</li> 
   </ul> </li> 
  <li><code>ActorSystem</code>: <code>Actor</code> 实例容器，负责创建<code>Actor</code> 实例、管理 <code>Actor</code> 实例的生命周期，和调度 <code>Actor</code> 实例的执行。</li> 
  <li><code>Timer</code>: 产生定时事件，生成超时 <code>Event</code> 并且发送给相关组件。</li> 
  <li><code>Reactor</code>: 处理 IO 传输，并且把 IO 结果以 <code>Event</code> 的方式传输给 <code>ChannelsActor</code>。</li> 
  <li><code>Address</code>: Actor实例之间相互隔离，他们之间通过 <code>Address</code> 进行消息的发送。</li> 
 </ul> 
 <p><img src="../../images/programming_model.drawio.svg" alt=""></p> 
 <p>使用 <code>otavia</code> 编程，用户必须先启动一个 <code>ActorSystem</code> 实例，这个实例代表了 <code>otavia</code> 的运行时。这个实例里面包含了调度 Actor 实例运行的线程池，<code>Timer</code> 组件、<code>Reactor</code> 组件。接下来用户只需要使用 <code>ActorSystem</code> 启动自己的 <code>Actor</code> 实例， <code>ActorSystem</code> 会向调用着返回对应 <code>Actor</code> 实例的地址。接下来，用户就可以通过这个 <code>Address</code> 向 Actor 发送消息了。 一旦 Actor 接收到消息，<code>ActorSystem</code> 就会分配一个线程来执行这个 Actor 实例。</p> 
 <p><img src="../../images/actor_instance.drawio.svg" alt=""></p> 
 <p>另一种 Actor 实例获得线程执行的条件是收到 <code>Event</code>。 在 <code>otavia</code> 中 <code>Event</code> 由 <code>Timer</code> 和 <code>Reactor</code> 产生， 用户 编程 时只需要关心由 <code>Timer</code> 产生的 <code>Event</code>， 处理由 <code>Reactor</code> 产生的 <code>Event</code> 由 <code>ChannelsActor</code> 进行了进一步的 封装。</p> 
</section> 
<section id="actor-3"> 
 <h2 class="h500"><a href="#actor-3" class="anchor"></a>Actor</h2> 
 <p><code>otavia</code> 中有两类基本的 <code>Actor</code> ，<code>StateActor</code> 和 <code>ChannelsActor</code>， 用户可以根据自己的需要选择继承其中的一种。</p> 
 <p><img src="../../images/two_types_actor.drawio.svg" alt=""></p> 
 <p><code>StateActor</code>: 普通 Actor ， 用户可以实现这种 Actor 来管理状态，发送、接收消息。这种 Actor 还可以与 <code>Timer</code> 进行交互 用于注册一个超时事件，当超时事件触发的时候， <code>Timer</code> 发向 Actor 发送 <code>Event</code>， 然后 <code>ActorSystem</code> 调度 Actor 执行 以处理 <code>Event</code>。</p> 
 <p><code>ChannelsActor</code>：</p> 
</section> 
<section id="types-of-channelsactor-1"> 
 <h3 class="h400"><a href="#types-of-channelsactor-1" class="anchor"></a>Types of ChannelsActor</h3> 
 <p><img src="../../images/actor_type.drawio.svg" alt=""></p> 
</section> 
<section id="channel-1"> 
 <h3 class="h400"><a href="#channel-1" class="anchor"></a>Channel</h3> 
 <p><img src="../../images/architecture_of_channel.drawio.svg" alt=""></p> 
</section> 
<section id="pipeline-1"> 
 <h4 class="h300"><a href="#pipeline-1" class="anchor"></a>Pipeline</h4> 
 <p><img src="../../images/pipeline.drawio.svg" alt=""></p> 
</section> 
<section id="channel-inflight-1"> 
 <h4 class="h300"><a href="#channel-inflight-1" class="anchor"></a>Channel Inflight</h4> 
 <p><img src="../../images/channel_inflight.drawio.svg" alt=""></p> 
</section> 
<section id="消息模型-1"> 
 <h2 class="h500"><a href="#消息模型-1" class="anchor"></a>消息模型</h2> 
 <p><img src="../../images/message_types.drawio.svg" alt=""></p> 
</section> 
<section id="事件-1"> 
 <h2 class="h500"><a href="#事件-1" class="anchor"></a>事件</h2> 
</section> 
<section id="stack-1"> 
 <h2 class="h500"><a href="#stack-1" class="anchor"></a>Stack</h2> 
 <p><img src="../../images/stack_resume.drawio.svg" alt=""></p> 
</section> 
<section id="timer-5"> 
 <h2 class="h500"><a href="#timer-5" class="anchor"></a>Timer</h2> 
</section> 
<section> 
 <h2 class="h500"><a href="#null" class="anchor"></a></h2> 
</section></div><div id="toc" class="body-small"><div id="toc-container"><span class="toc-title h200">In this article</span><nav class="toc-nav"><ul class="toc-list"><li><a href="#现有编程模型的挑战-1">现有编程模型的挑战</a></li><li><a href="#核心运行时-1">核心运行时</a></li><li><a href="#actor-3">Actor</a><ul><li><a href="#types-of-channelsactor-1">Types of ChannelsActor</a></li><li><a href="#channel-1">Channel</a><ul><li><a href="#pipeline-1">Pipeline</a></li><li><a href="#channel-inflight-1">Channel Inflight</a></li></ul></li></ul></li><li><a href="#消息模型-1">消息模型</a></li><li><a href="#事件-1">事件</a></li><li><a href="#stack-1">Stack</a></li><li><a href="#timer-5">Timer</a></li></ul></nav></div></div></div><div id="footer" class="body-small mobile-footer"><div class="left-container">Generated with</div><div class="right-container"><a href="https://github.com/lampepfl/dotty"><button class="icon-button gh"></button></a><a href="https://twitter.com/scala_lang"><button class="icon-button twitter"></button></a><a href="https://discord.com/invite/scala"><button class="icon-button discord"></button></a><a href="https://gitter.im/scala/scala"><button class="icon-button gitter"></button></a><div class="text">Copyright (c) 2022, Yan Kun/Otavia Project</div></div><div class="text-mobile">Copyright (c) 2022, Yan Kun/Otavia Project</div></div></div></div></body></html>